{"version":3,"file":"FRouter.umd.js","sources":["../src/template/router-view.js","../src/template/router-link.js","../src/core/install.js","../src/utils/History.js","../src/core/index.js"],"sourcesContent":["export default {\r\n    name: 'RouterView',\r\n    functional: true,\r\n    props: {\r\n        name: {\r\n            type: String,\r\n            default: 'default'\r\n        }\r\n    },\r\n    data () {\r\n        return {\r\n        }\r\n    },\r\n    render(_, { parent, data }) {\r\n\r\n        // router-view will be rendered as matched component \r\n        let hash = parent.$router.currentHash\r\n        \r\n        if (hash[0] === '#') {\r\n            hash = hash.split('')\r\n            hash.shift()\r\n            hash = hash.join('')\r\n        }\r\n\r\n        let options = {}\r\n\r\n        let renderCore = () => {\r\n            if (typeof parent.$vnode.data._childrenMap === 'undefined') {\r\n                let currentMap = parent.$router.routeMap\r\n                let matched = []\r\n                currentMap.forEach(item => {\r\n                    let index = hash.indexOf(item.path)\r\n                    if (index === 0) {\r\n                        matched.push(item)\r\n                    }\r\n                })\r\n\r\n                // matched nothing\r\n                if (matched.length === 0) {\r\n                    return\r\n                }\r\n\r\n                if (matched[matched.length-1].redirect) {\r\n                    hash = hash.replace(matched[matched.length-1].path, matched[matched.length-1].redirect)\r\n                    location.hash = '#' + hash\r\n                    return renderCore()\r\n                }\r\n\r\n                if (typeof matched[matched.length-1].children !== 'undefined') {\r\n                    data._childrenMap = matched[matched.length-1].children\r\n                    data._hashChip = matched[matched.length-1].path\r\n                }\r\n\r\n                options.data = data\r\n                options.component = matched[matched.length-1].component\r\n            } else {\r\n                let currentMap = parent.$vnode.data._childrenMap\r\n                let parentHashChip = parent.$vnode.data._hashChip\r\n                let matched = []\r\n\r\n                if (parentHashChip[parentHashChip.length-1] !== '/') {\r\n                    parentHashChip += '/'\r\n                }\r\n                \r\n                currentMap.forEach(item => {\r\n                    let index = hash.indexOf(parentHashChip + item.path)\r\n                    if (index !== -1) {\r\n                        matched.push(item)\r\n                    }\r\n                })\r\n\r\n                if (matched.length === 0) {\r\n                    return\r\n                }\r\n                \r\n                if (matched[matched.length-1].redirect) {\r\n                    hash = hash.replace(matched[matched.length-1].path, matched[matched.length-1].redirect)\r\n                    location.hash = '#' + hash\r\n                    return renderCore()\r\n                }\r\n\r\n                if (matched[matched.length-1].children) {\r\n                    data._childrenMap = matched[matched.length-1].children\r\n                    data._hashChip = matched[matched.length-1].path\r\n                }\r\n\r\n                options.data = data\r\n                options.component = matched[matched.length-1].component\r\n            }\r\n        }\r\n        \r\n        renderCore()\r\n\r\n        return _(options.component, options.data)\r\n\r\n    }\r\n}\r\n\r\n\r\n","export default {\r\n    name: 'RouterLink',\r\n    functional: true,\r\n    props: {\r\n        to: {\r\n            type: String,\r\n            required: true\r\n        },\r\n        tag: {\r\n            type: String,\r\n            default: 'a'\r\n        },\r\n    },\r\n    render(h, { props, data, children }) {\r\n        data.on = {\r\n            click () {\r\n                location.hash = props.to\r\n            }\r\n        }\r\n        \r\n        return h(\r\n            props.tag, \r\n            data,\r\n            children\r\n        )\r\n    },\r\n}\r\n\r\n","import RouterView from '../template/router-view.js'\r\nimport RouterLink from '../template/router-link.js'\r\n\r\nconst isDef = v => v !== undefined\r\n\r\nconst install = function (Vue) {\r\n\r\n    Vue.mixin({\r\n        beforeCreate () {\r\n            if (isDef(this.$options.router)) {\r\n                this._routerRoot = this\r\n                this._router = this.$options.router\r\n                this._router.initHistory()\r\n            } else {\r\n                this._routerRoot = (this.$parent && this.$parent._routerRoot) || this\r\n            }\r\n        }\r\n    })\r\n\r\n    Object.defineProperty(Vue.prototype, '$router', {\r\n        get () {\r\n            return this._routerRoot._router\r\n        }\r\n    })\r\n\r\n    Vue.component('RouterView', RouterView)\r\n    Vue.component('RouterLink', RouterLink)\r\n    \r\n}\r\n\r\nexport default install","class History {\r\n    constructor (router) {\r\n        this.router = router\r\n    }\r\n\r\n    initHistory () {\r\n        this.Stack = []\r\n        this.Stack.push(this.router.currentHash)\r\n    }\r\n\r\n    push (url) {\r\n        location.href = url\r\n        this.Stack.push(this.router.currentHash)\r\n    }\r\n\r\n    back () {\r\n        let index = this.Stack.indexOf(this.router.currentHash)\r\n        if (index > 0) {\r\n            location.href = this.Stack[index-1]\r\n        } else {\r\n            location.reload()\r\n        }\r\n    }\r\n\r\n    forward () {\r\n        let index = this.Stack.indexOf(this.router.currentHash)\r\n        if (index < this.Stack.length) {\r\n            location.href = this.Stack[index+1]\r\n        } else {\r\n            location.reload()\r\n        }\r\n    }\r\n    \r\n}\r\n\r\n\r\nexport default History","import install from './install'\r\nimport History from '../utils/History'\r\n\r\nwindow.onhashchange = function () {\r\n    location.reload()\r\n}\r\n\r\nclass FRouter {\r\n    constructor (options) {\r\n        this.routeMap = options.routes\r\n    }\r\n\r\n    // get href () {\r\n\r\n    // }\r\n\r\n    get currentHash () {\r\n\r\n        let hash = window.location.hash\r\n        // let index = hash.indexOf('#')\r\n        \r\n        return hash\r\n    }\r\n\r\n    initHistory () {\r\n        this.history.initHistory()\r\n    }\r\n\r\n    push (url) {\r\n        this.history.push(url)\r\n    } \r\n\r\n    back () {\r\n        this.history.back()\r\n    }\r\n\r\n    forward () {\r\n        this.history.forward()\r\n    }\r\n}\r\n\r\nFRouter.install = install\r\nFRouter.prototype.history = new History(FRouter.prototype)\r\n\r\nexport default FRouter"],"names":["name","functional","props","type","String","data","render","_","parent","hash","$router","currentHash","split","shift","join","options","renderCore","$vnode","_childrenMap","currentMap","routeMap","matched","forEach","item","index","indexOf","path","push","length","redirect","replace","location","children","_hashChip","component","parentHashChip","to","required","tag","h","on","click","isDef","v","undefined","install","Vue","mixin","beforeCreate","$options","router","_routerRoot","_router","initHistory","$parent","Object","defineProperty","prototype","get","RouterView","RouterLink","History","Stack","url","href","reload","window","onhashchange","FRouter","routes","history","back","forward"],"mappings":"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"}